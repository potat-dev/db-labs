## 16. Даталогическое проектирование. Вторая нормальная форма.

### Ответ:

Переход ко второй нормальной форме (2NF) становится актуальным, когда в таблицах присутствуют составные первичные ключи,  то есть ключи,  состоящие из  нескольких атрибутов. 

**Определение:** Отношение находится в 2NF, если:

1. **Оно находится в 1NF.**
2. **Все неключевые атрибуты полностью зависят от всего составного первичного ключа,  а не от его части.**

**Пример отношения, не находящегося в 2NF:**

Рассмотрим таблицу "Заказы",  где первичный ключ состоит из атрибутов "НомерЗаказа" и "КодТовара":

| НомерЗаказа | КодТовара | НазваниеТовара | ЦенаТовара | ФИОКлиента  |
| ----------- | --------- | -------------- | ---------- | ----------- |
| 1           | A1        | Книга          | 10         | Иванов Иван |
| 1           | B2        | Тетрадь        | 2          | Иванов Иван |
| 2           | A1        | Книга          | 10         | Петров Петр |

**Проблема:**

* Атрибуты "НазваниеТовара"  и  "ЦенаТовара" зависят только от части первичного ключа - "КодТовара",  а  не  от  всего  ключа  ("НомерЗаказа",  "КодТовара").

**Последствия:**

* **Избыточность данных:**  Информация  о  названии  и  цене  товара  дублируется  для  каждого  заказа,  в  котором  он  присутствует.
* **Аномалия  обновления:**  Если  изменится  название  или  цена  товара,  придется  обновить  множество  строк  в  таблице.

**Преобразование в 2NF:**

Чтобы привести отношение к 2NF, нужно:

1. **Выделить  атрибуты,  зависящие  от  части  первичного  ключа:**  В  данном  случае  это  "НазваниеТовара"  и  "ЦенаТовара".
2. **Создать  новую  таблицу  для  этих  атрибутов  и  части  ключа,  от  которой  они  зависят:**  Новая  таблица  будет  иметь  первичный  ключ  "КодТовара".

**Нормализованные отношения (в 2NF):**

**Таблица "Заказы":**

| НомерЗаказа | КодТовара | ФИОКлиента  |
| ----------- | --------- | ----------- |
| 1           | A1        | Иванов Иван |
| 1           | B2        | Иванов Иван |
| 2           | A1        | Петров Петр |

**Таблица "Товары":**

| КодТовара | НазваниеТовара | ЦенаТовара |
| --------- | -------------- | ---------- |
| A1        | Книга          | 10         |
| B2        | Тетрадь        | 2          |

**Преимущества 2NF:**

* **Устранение избыточности данных:**  Информация  о  товарах  хранится  только  в  одном  месте.
* **Упрощение модификации данных:**  Изменение  информации  о  товаре  требует  обновления  только  одной  строки  в  таблице  "Товары".

**Важно:**

* 2NF  устраняет  только  частичные  зависимости  от  первичного  ключа.  
* Для  полного  устранения  избыточности  и  аномалий  модификации  необходимо  приводить  отношения  к  3NF. 
